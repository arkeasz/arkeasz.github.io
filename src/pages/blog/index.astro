---
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Initial from '../../components/Initial.astro';

import { getCollection, getEntry } from 'astro:content'

const posts =  (await getCollection('blog')).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
        console.log(posts)

---
<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
    <body>
		<Header />
		<main>
			<Initial />
            <section class="posts">
                <h2>My posts</h2>
                <ul>
                    {
                        posts.filter(post => post.data.pub).map(post => (
                            <li>
                                <a href={`/blog/${post.id}`}>
                                    {post.data.title}
                                </a>
                                <p class="description">
                                    {post.data.description}
                                </p>
                                <p class="date">
                                    {
                                        new Date(post.data.pubDate).getDate().toString() + 
                                        '/' + 
                                        new Date(post.data.pubDate).getMonth() + 1 +
                                        '/' + 
                                        new Date(post.data.pubDate).getFullYear()
                                    }
                                </p>
                            </li>    
                        ))
                    }
                </ul>
            </section>
			<section class="end">
				  © 2026 arkirus · all rights reserved
			</section>
		</main>
	</body>
</html>

<style>
    main {
        display: flex;
        flex-direction: column;

    }
    .posts {
        padding: 1rem;
        width: calc(100% - 2rem);
        min-height: calc(80vh - 2rem);
        margin: 0;
    }

    ul {
        display: flex;
        flex-direction: column;
        padding: 0;
        gap: .5rem;

    }

    li {
        padding: 1rem;
        background-color: rgba(217, 216, 216, 0.46);
        display: grid;
        /* justify-content: space-between; */
        /* align-items: flex-start; */
        gap: .56rem;
    }

    p {
        padding: 0;
        margin: 0;
        display: inline;
    }

    .description {
        justify-self: start;
    }
    .date {
        justify-self: end;
    }
</style>